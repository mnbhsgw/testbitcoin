{"ast":null,"code":"var _jsxFileName = \"/Users/manabu/Downloads/btc-arbitrage-webapp_claudecode/client/src/PriceChart.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, TimeScale } from 'chart.js';\nimport { Line } from 'react-chartjs-2';\nimport 'chartjs-adapter-date-fns';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, TimeScale);\nconst PriceChart = ({\n  prices,\n  ws\n}) => {\n  _s();\n  const [chartData, setChartData] = useState({\n    datasets: []\n  });\n  const [timeRange, setTimeRange] = useState(1);\n  const [realtimeData, setRealtimeData] = useState({});\n  const chartRef = useRef();\n  const exchangeColors = {\n    'bitFlyer': '#ff6b6b',\n    'Coincheck': '#4ecdc4',\n    'Zaif': '#45b7d1',\n    'GMOコイン': '#96ceb4',\n    'bitbank': '#ffeaa7'\n  };\n  const fetchPriceHistory = async () => {\n    try {\n      const response = await axios.get(`/api/price-history?hours=${timeRange}`);\n      const priceHistory = response.data.priceHistory;\n      console.log(`Fetched ${priceHistory.length} records for ${timeRange} hours`);\n\n      // データを取引所ごとにグループ化\n      const groupedData = {};\n      priceHistory.forEach(record => {\n        if (!groupedData[record.exchange]) {\n          groupedData[record.exchange] = [];\n        }\n        groupedData[record.exchange].push({\n          x: new Date(record.timestamp),\n          y: record.price\n        });\n      });\n\n      // Chart.js用のデータセットを作成\n      const datasets = Object.keys(groupedData).map(exchange => ({\n        label: exchange,\n        data: groupedData[exchange],\n        borderColor: exchangeColors[exchange] || '#666',\n        backgroundColor: exchangeColors[exchange] || '#666',\n        borderWidth: 2,\n        fill: false,\n        tension: 0.1,\n        pointRadius: 1,\n        pointHoverRadius: 4\n      }));\n      setChartData({\n        datasets\n      });\n\n      // チャートの再描画を強制\n      if (chartRef.current) {\n        chartRef.current.update('none');\n      }\n    } catch (error) {\n      console.error('Error fetching price history:', error);\n    }\n  };\n\n  // リアルタイムデータでチャートを更新\n  const updateChartWithRealtime = newPrices => {\n    if (!newPrices || newPrices.length === 0) return;\n    const now = new Date();\n    const newRealtimeData = {\n      ...realtimeData\n    };\n    newPrices.forEach(price => {\n      if (!newRealtimeData[price.exchange]) {\n        newRealtimeData[price.exchange] = [];\n      }\n\n      // 最新のデータポイントを追加\n      newRealtimeData[price.exchange].push({\n        x: now,\n        y: price.price\n      });\n\n      // 古いデータを削除（直近1時間分のみ保持）\n      const oneHourAgo = new Date(now.getTime() - 60 * 60 * 1000);\n      newRealtimeData[price.exchange] = newRealtimeData[price.exchange].filter(point => point.x > oneHourAgo);\n    });\n    setRealtimeData(newRealtimeData);\n\n    // 現在のチャートデータにリアルタイムデータを追加\n    setChartData(prevData => {\n      const updatedDatasets = prevData.datasets.map(dataset => {\n        const exchangeName = dataset.label;\n        const realtimePoints = newRealtimeData[exchangeName] || [];\n\n        // 既存のデータと新しいリアルタイムデータを結合\n        const allData = [...dataset.data];\n        realtimePoints.forEach(point => {\n          // 重複を避けるため、同じ時刻のデータは更新\n          const existingIndex = allData.findIndex(p => Math.abs(p.x.getTime() - point.x.getTime()) < 5000 // 5秒以内なら同じとみなす\n          );\n          if (existingIndex >= 0) {\n            allData[existingIndex] = point;\n          } else {\n            allData.push(point);\n          }\n        });\n\n        // 時刻順にソート\n        allData.sort((a, b) => a.x.getTime() - b.x.getTime());\n        return {\n          ...dataset,\n          data: allData\n        };\n      });\n      return {\n        datasets: updatedDatasets\n      };\n    });\n  };\n\n  // WebSocketでリアルタイム更新を受信\n  useEffect(() => {\n    if (prices && prices.length > 0) {\n      updateChartWithRealtime(prices);\n    }\n  }, [prices]);\n  useEffect(() => {\n    // チャートデータをリセットして強制的に再描画\n    setChartData({\n      datasets: []\n    });\n    setRealtimeData({});\n    fetchPriceHistory();\n    const interval = setInterval(fetchPriceHistory, 30000); // 30秒ごとに更新\n    return () => clearInterval(interval);\n  }, [timeRange]);\n  const calculateTimeRange = () => {\n    const now = new Date();\n    const startTime = new Date(now.getTime() - timeRange * 60 * 60 * 1000);\n    return {\n      min: startTime,\n      max: now\n    };\n  };\n\n  // チャートオプションを動的に生成する関数\n  const getChartOptions = () => {\n    const timeRangeData = calculateTimeRange();\n    return {\n      responsive: true,\n      maintainAspectRatio: false,\n      plugins: {\n        legend: {\n          position: 'top'\n        },\n        title: {\n          display: true,\n          text: `BTC/JPY 価格推移 (過去${timeRange}時間)`\n        },\n        tooltip: {\n          mode: 'index',\n          intersect: false,\n          callbacks: {\n            label: function (context) {\n              return `${context.dataset.label}: ¥${context.parsed.y.toLocaleString()}`;\n            }\n          }\n        }\n      },\n      scales: {\n        x: {\n          type: 'time',\n          time: {\n            displayFormats: {\n              hour: 'HH:mm',\n              minute: 'HH:mm'\n            }\n          },\n          title: {\n            display: true,\n            text: '時刻'\n          },\n          min: timeRangeData.min,\n          max: timeRangeData.max,\n          adapters: {\n            date: {}\n          }\n        },\n        y: {\n          type: 'linear',\n          title: {\n            display: true,\n            text: '価格 (JPY)'\n          },\n          ticks: {\n            callback: function (value) {\n              return '¥' + value.toLocaleString();\n            }\n          },\n          beginAtZero: false,\n          grace: '5%',\n          min: undefined,\n          max: undefined\n        }\n      },\n      interaction: {\n        mode: 'nearest',\n        axis: 'x',\n        intersect: false\n      }\n    };\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"price-chart\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"control-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"timeRange\",\n          children: \"\\u8868\\u793A\\u671F\\u9593: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          id: \"timeRange\",\n          value: timeRange,\n          onChange: e => setTimeRange(parseInt(e.target.value)),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: 0.5,\n            children: \"30\\u5206\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: 1,\n            children: \"1\\u6642\\u9593\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: 2,\n            children: \"2\\u6642\\u9593\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: 6,\n            children: \"6\\u6642\\u9593\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: 12,\n            children: \"12\\u6642\\u9593\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: 24,\n            children: \"24\\u6642\\u9593\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: 72,\n            children: \"3\\u65E5\\u9593\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: 168,\n            children: \"1\\u9031\\u9593\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"control-group\",\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          href: `http://localhost:3001/api/export-csv?hours=${timeRange}`,\n          download: true,\n          className: \"export-button\",\n          children: \"\\uD83D\\uDCCA CSV\\u51FA\\u529B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-container\",\n      children: /*#__PURE__*/_jsxDEV(Line, {\n        ref: chartRef,\n        data: chartData,\n        options: getChartOptions()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 239,\n    columnNumber: 5\n  }, this);\n};\n_s(PriceChart, \"cIQ3EsoOP81sHjP8E+8rNTinHvg=\");\n_c = PriceChart;\nexport default PriceChart;\nvar _c;\n$RefreshReg$(_c, \"PriceChart\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","TimeScale","Line","axios","jsxDEV","_jsxDEV","register","PriceChart","prices","ws","_s","chartData","setChartData","datasets","timeRange","setTimeRange","realtimeData","setRealtimeData","chartRef","exchangeColors","fetchPriceHistory","response","get","priceHistory","data","console","log","length","groupedData","forEach","record","exchange","push","x","Date","timestamp","y","price","Object","keys","map","label","borderColor","backgroundColor","borderWidth","fill","tension","pointRadius","pointHoverRadius","current","update","error","updateChartWithRealtime","newPrices","now","newRealtimeData","oneHourAgo","getTime","filter","point","prevData","updatedDatasets","dataset","exchangeName","realtimePoints","allData","existingIndex","findIndex","p","Math","abs","sort","a","b","interval","setInterval","clearInterval","calculateTimeRange","startTime","min","max","getChartOptions","timeRangeData","responsive","maintainAspectRatio","plugins","legend","position","title","display","text","tooltip","mode","intersect","callbacks","context","parsed","toLocaleString","scales","type","time","displayFormats","hour","minute","adapters","date","ticks","callback","value","beginAtZero","grace","undefined","interaction","axis","className","children","htmlFor","fileName","_jsxFileName","lineNumber","columnNumber","id","onChange","e","parseInt","target","href","download","ref","options","_c","$RefreshReg$"],"sources":["/Users/manabu/Downloads/btc-arbitrage-webapp_claudecode/client/src/PriceChart.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend,\n  TimeScale,\n} from 'chart.js';\nimport { Line } from 'react-chartjs-2';\nimport 'chartjs-adapter-date-fns';\nimport axios from 'axios';\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend,\n  TimeScale\n);\n\nconst PriceChart = ({ prices, ws }) => {\n  const [chartData, setChartData] = useState({\n    datasets: []\n  });\n  const [timeRange, setTimeRange] = useState(1);\n  const [realtimeData, setRealtimeData] = useState({});\n  const chartRef = useRef();\n\n  const exchangeColors = {\n    'bitFlyer': '#ff6b6b',\n    'Coincheck': '#4ecdc4', \n    'Zaif': '#45b7d1',\n    'GMOコイン': '#96ceb4',\n    'bitbank': '#ffeaa7'\n  };\n\n  const fetchPriceHistory = async () => {\n    try {\n      const response = await axios.get(`/api/price-history?hours=${timeRange}`);\n      const priceHistory = response.data.priceHistory;\n      \n      console.log(`Fetched ${priceHistory.length} records for ${timeRange} hours`);\n      \n      // データを取引所ごとにグループ化\n      const groupedData = {};\n      priceHistory.forEach(record => {\n        if (!groupedData[record.exchange]) {\n          groupedData[record.exchange] = [];\n        }\n        groupedData[record.exchange].push({\n          x: new Date(record.timestamp),\n          y: record.price\n        });\n      });\n\n      // Chart.js用のデータセットを作成\n      const datasets = Object.keys(groupedData).map(exchange => ({\n        label: exchange,\n        data: groupedData[exchange],\n        borderColor: exchangeColors[exchange] || '#666',\n        backgroundColor: exchangeColors[exchange] || '#666',\n        borderWidth: 2,\n        fill: false,\n        tension: 0.1,\n        pointRadius: 1,\n        pointHoverRadius: 4\n      }));\n\n      setChartData({ datasets });\n      \n      // チャートの再描画を強制\n      if (chartRef.current) {\n        chartRef.current.update('none');\n      }\n    } catch (error) {\n      console.error('Error fetching price history:', error);\n    }\n  };\n\n  // リアルタイムデータでチャートを更新\n  const updateChartWithRealtime = (newPrices) => {\n    if (!newPrices || newPrices.length === 0) return;\n    \n    const now = new Date();\n    const newRealtimeData = { ...realtimeData };\n    \n    newPrices.forEach(price => {\n      if (!newRealtimeData[price.exchange]) {\n        newRealtimeData[price.exchange] = [];\n      }\n      \n      // 最新のデータポイントを追加\n      newRealtimeData[price.exchange].push({\n        x: now,\n        y: price.price\n      });\n      \n      // 古いデータを削除（直近1時間分のみ保持）\n      const oneHourAgo = new Date(now.getTime() - 60 * 60 * 1000);\n      newRealtimeData[price.exchange] = newRealtimeData[price.exchange]\n        .filter(point => point.x > oneHourAgo);\n    });\n    \n    setRealtimeData(newRealtimeData);\n    \n    // 現在のチャートデータにリアルタイムデータを追加\n    setChartData(prevData => {\n      const updatedDatasets = prevData.datasets.map(dataset => {\n        const exchangeName = dataset.label;\n        const realtimePoints = newRealtimeData[exchangeName] || [];\n        \n        // 既存のデータと新しいリアルタイムデータを結合\n        const allData = [...dataset.data];\n        realtimePoints.forEach(point => {\n          // 重複を避けるため、同じ時刻のデータは更新\n          const existingIndex = allData.findIndex(p => \n            Math.abs(p.x.getTime() - point.x.getTime()) < 5000 // 5秒以内なら同じとみなす\n          );\n          if (existingIndex >= 0) {\n            allData[existingIndex] = point;\n          } else {\n            allData.push(point);\n          }\n        });\n        \n        // 時刻順にソート\n        allData.sort((a, b) => a.x.getTime() - b.x.getTime());\n        \n        return {\n          ...dataset,\n          data: allData\n        };\n      });\n      \n      return { datasets: updatedDatasets };\n    });\n  };\n\n  // WebSocketでリアルタイム更新を受信\n  useEffect(() => {\n    if (prices && prices.length > 0) {\n      updateChartWithRealtime(prices);\n    }\n  }, [prices]);\n\n  useEffect(() => {\n    // チャートデータをリセットして強制的に再描画\n    setChartData({ datasets: [] });\n    setRealtimeData({});\n    \n    fetchPriceHistory();\n    const interval = setInterval(fetchPriceHistory, 30000); // 30秒ごとに更新\n    return () => clearInterval(interval);\n  }, [timeRange]);\n\n  const calculateTimeRange = () => {\n    const now = new Date();\n    const startTime = new Date(now.getTime() - timeRange * 60 * 60 * 1000);\n    return { min: startTime, max: now };\n  };\n\n  // チャートオプションを動的に生成する関数\n  const getChartOptions = () => {\n    const timeRangeData = calculateTimeRange();\n    return {\n      responsive: true,\n      maintainAspectRatio: false,\n      plugins: {\n        legend: {\n          position: 'top',\n        },\n        title: {\n          display: true,\n          text: `BTC/JPY 価格推移 (過去${timeRange}時間)`\n        },\n        tooltip: {\n          mode: 'index',\n          intersect: false,\n          callbacks: {\n            label: function(context) {\n              return `${context.dataset.label}: ¥${context.parsed.y.toLocaleString()}`;\n            }\n          }\n        }\n      },\n      scales: {\n        x: {\n          type: 'time',\n          time: {\n            displayFormats: {\n              hour: 'HH:mm',\n              minute: 'HH:mm'\n            }\n          },\n          title: {\n            display: true,\n            text: '時刻'\n          },\n          min: timeRangeData.min,\n          max: timeRangeData.max,\n          adapters: {\n            date: {}\n          }\n        },\n        y: {\n          type: 'linear',\n          title: {\n            display: true,\n            text: '価格 (JPY)'\n          },\n          ticks: {\n            callback: function(value) {\n              return '¥' + value.toLocaleString();\n            }\n          },\n          beginAtZero: false,\n          grace: '5%',\n          min: undefined,\n          max: undefined\n        }\n      },\n      interaction: {\n        mode: 'nearest',\n        axis: 'x',\n        intersect: false\n      }\n    };\n  };\n\n\n  return (\n    <div className=\"price-chart\">\n      <div className=\"chart-controls\">\n        <div className=\"control-group\">\n          <label htmlFor=\"timeRange\">表示期間: </label>\n          <select \n            id=\"timeRange\"\n            value={timeRange} \n            onChange={(e) => setTimeRange(parseInt(e.target.value))}\n          >\n            <option value={0.5}>30分</option>\n            <option value={1}>1時間</option>\n            <option value={2}>2時間</option>\n            <option value={6}>6時間</option>\n            <option value={12}>12時間</option>\n            <option value={24}>24時間</option>\n            <option value={72}>3日間</option>\n            <option value={168}>1週間</option>\n          </select>\n        </div>\n        <div className=\"control-group\">\n          <a \n            href={`http://localhost:3001/api/export-csv?hours=${timeRange}`}\n            download\n            className=\"export-button\"\n          >\n            📊 CSV出力\n          </a>\n        </div>\n      </div>\n      <div className=\"chart-container\">\n        <Line ref={chartRef} data={chartData} options={getChartOptions()} />\n      </div>\n    </div>\n  );\n};\n\nexport default PriceChart;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}